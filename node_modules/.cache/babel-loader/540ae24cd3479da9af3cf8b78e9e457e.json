{"ast":null,"code":"import _slicedToArray from\"/home/ryan/Music/SantuyApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useContext,useEffect,useRef,useState}from\"react\";import'../assets/scss/FooterPlayer.scss';import RepeatIcon from'@material-ui/icons/Repeat';import RepeatOneIcon from'@material-ui/icons/RepeatOne';import SkipPreviousIcon from'@material-ui/icons/SkipPrevious';import SkipNextIcon from'@material-ui/icons/SkipNext';import PlayArrowIcon from'@material-ui/icons/PlayArrow';import PauseIcon from'@material-ui/icons/Pause';import VolumeUpIcon from'@material-ui/icons/VolumeUp';import VolumeOffIcon from'@material-ui/icons/VolumeOff';import Slider from\"@material-ui/core/Slider\";import{Avatar}from\"@material-ui/core\";import ControlsToggleButton from\"./ControlsToggleButton\";import Name from\"./Name\";import{ThemeContext}from\"../../api/Theme\";import{useDispatch,useSelector}from\"react-redux\";import{setBannerOpen,setCurrentPlaying}from\"../../actions/actions\";import Button from\"@material-ui/core/Button\";function FooterMusicPlayer(_ref){var music=_ref.music;var _useState=useState(music),_useState2=_slicedToArray(_useState,2),_useState2$=_useState2[0],id=_useState2$.id,name=_useState2$.name,author_name=_useState2$.author_name,img=_useState2$.img,musicName=_useState2$.musicName,setCurrTrack=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isRepeatClicked=_useState4[0],setRepeatClick=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isPrevClicked=_useState6[0],setPrevClicked=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isNextClicked=_useState8[0],setNextClicked=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isPlaying=_useState10[0],setPlayPauseClicked=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isVolumeClicked=_useState12[0],setVolumeClicked=_useState12[1];var _useState13=useState(50),_useState14=_slicedToArray(_useState13,2),volume=_useState14[0],setVolume=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),seekTime=_useState16[0],setSeekTime=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),duration=_useState18[0],setDuration=_useState18[1];var _useState19=useState(0),_useState20=_slicedToArray(_useState19,2),currTime=_useState20[0],setCurrTime=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),bannerToggle=_useState22[0],setBannerToggle=_useState22[1];var audioElement=useRef();var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.musicReducer;}),playlists=_useSelector.playlists;var useStyle=useContext(ThemeContext);var pointer={cursor:\"pointer\",color:useStyle.theme};var handleToggle=function handleToggle(type,val){switch(type){case\"repeat\":setRepeatClick(val);break;case\"prev\":setPrevClicked(val);break;case\"play-pause\":setPlayPauseClicked(val);break;case\"next\":setNextClicked(val);break;case\"volume\":setVolumeClicked(val);break;default:break;}};var handleSeekChange=function handleSeekChange(event,newValue){audioElement.current.currentTime=newValue*duration/100;setSeekTime(newValue);};var handleVolumeChange=function handleVolumeChange(event,newValue){setVolume(newValue);};var handleBannerToggle=function handleBannerToggle(){setBannerToggle(!bannerToggle);};useEffect(function(){dispatch(setBannerOpen(bannerToggle));},[dispatch,bannerToggle]);useEffect(function(){isPlaying?audioElement.current.play().then(function(){}).catch(function(e){audioElement.current.pause();audioElement.current.currentTime=0;}):audioElement.current.pause();audioElement.current.loop=isRepeatClicked;audioElement.current.volume=volume/100;audioElement.current.muted=isVolumeClicked;audioElement.current.onloadeddata=function(){if(audioElement.current!=null)setDuration(audioElement.current.duration);};setInterval(function(){if(audioElement.current!==null)setCurrTime(audioElement.current.currentTime);});});useEffect(function(){setCurrTrack(music);},[music]);useEffect(function(){setSeekTime(currTime/(duration/100));},[currTime,duration]);useEffect(function(){audioElement.current.onended=function(){setNextClicked(true);};});useEffect(function(){if(isNextClicked){var currTrackId=(id+1)%playlists.length;dispatch(setCurrentPlaying(playlists[currTrackId]));setNextClicked(false);}if(isPrevClicked){var _currTrackId=(id-1)%playlists.length;if(id-1<0){_currTrackId=playlists.length-1;}dispatch(setCurrentPlaying(playlists[_currTrackId]));setPrevClicked(false);}},[dispatch,id,isNextClicked,isPrevClicked,playlists]);function formatTime(secs){var t=new Date(1970,0,1);t.setSeconds(secs);var s=t.toTimeString().substr(0,8);if(secs>86399)s=Math.floor((t-Date.parse(\"1/1/70\"))/3600000)+s.substr(2);return s.substring(3);}return/*#__PURE__*/_jsxs(\"div\",{style:useStyle.component,className:\"footer-player\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"playback\",children:!isNaN(seekTime)&&/*#__PURE__*/_jsx(Slider,{style:{color:useStyle.theme},className:\"playback-completed\",value:seekTime,onChange:handleSeekChange})}),/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(Avatar,{variant:\"square\",src:require(\"../assets/img/\"+img).default,alt:name}),onClick:handleBannerToggle,className:\"curr-music-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"curr-music-details\",children:[/*#__PURE__*/_jsx(Name,{name:name,className:\"song-name\",length:name.length}),/*#__PURE__*/_jsx(Name,{name:author_name,className:\"author-name\",length:author_name.length})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"playback-controls\",children:[/*#__PURE__*/_jsx(ControlsToggleButton,{style:pointer,type:\"repeat\",defaultIcon:/*#__PURE__*/_jsx(RepeatIcon,{fontSize:\"large\"}),changeIcon:/*#__PURE__*/_jsx(RepeatOneIcon,{fontSize:\"large\"}),onClicked:handleToggle}),/*#__PURE__*/_jsx(ControlsToggleButton,{style:pointer,type:\"prev\",defaultIcon:/*#__PURE__*/_jsx(SkipPreviousIcon,{fontSize:\"large\"}),change:true,Icon:/*#__PURE__*/_jsx(SkipPreviousIcon,{fontSize:\"large\"}),onClicked:handleToggle}),/*#__PURE__*/_jsx(\"audio\",{ref:audioElement,src:require(\"../assets/music/\"+musicName).default,preload:\"metadata\"}),/*#__PURE__*/_jsx(ControlsToggleButton,{style:pointer,type:\"play-pause\",defaultIcon:/*#__PURE__*/_jsx(PlayArrowIcon,{fontSize:\"large\"}),changeIcon:/*#__PURE__*/_jsx(PauseIcon,{fontSize:\"large\"}),onClicked:handleToggle}),/*#__PURE__*/_jsx(ControlsToggleButton,{style:pointer,type:\"next\",defaultIcon:/*#__PURE__*/_jsx(SkipNextIcon,{fontSize:\"large\"}),changeIcon:/*#__PURE__*/_jsx(SkipNextIcon,{fontSize:\"large\"}),onClicked:handleToggle})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"playback-widgets\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"timer\",children:/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:formatTime(currTime)}),\"/\",/*#__PURE__*/_jsx(\"span\",{children:formatTime(duration)})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"slider\",children:/*#__PURE__*/_jsx(Slider,{style:{color:useStyle.theme},value:volume,onChange:handleVolumeChange})}),/*#__PURE__*/_jsx(ControlsToggleButton,{style:pointer,type:\"volume\",defaultIcon:/*#__PURE__*/_jsx(VolumeUpIcon,{}),changeIcon:/*#__PURE__*/_jsx(VolumeOffIcon,{}),onClicked:handleToggle})]})]});}export default FooterMusicPlayer;","map":{"version":3,"sources":["/home/ryan/Music/SantuyApp/src/components/fragment/FooterMusicPlayer.jsx"],"names":["React","useContext","useEffect","useRef","useState","RepeatIcon","RepeatOneIcon","SkipPreviousIcon","SkipNextIcon","PlayArrowIcon","PauseIcon","VolumeUpIcon","VolumeOffIcon","Slider","Avatar","ControlsToggleButton","Name","ThemeContext","useDispatch","useSelector","setBannerOpen","setCurrentPlaying","Button","FooterMusicPlayer","music","id","name","author_name","img","musicName","setCurrTrack","isRepeatClicked","setRepeatClick","isPrevClicked","setPrevClicked","isNextClicked","setNextClicked","isPlaying","setPlayPauseClicked","isVolumeClicked","setVolumeClicked","volume","setVolume","seekTime","setSeekTime","duration","setDuration","currTime","setCurrTime","bannerToggle","setBannerToggle","audioElement","dispatch","state","musicReducer","playlists","useStyle","pointer","cursor","color","theme","handleToggle","type","val","handleSeekChange","event","newValue","current","currentTime","handleVolumeChange","handleBannerToggle","play","then","catch","e","pause","loop","muted","onloadeddata","setInterval","onended","currTrackId","length","formatTime","secs","t","Date","setSeconds","s","toTimeString","substr","Math","floor","parse","substring","component","isNaN","require","default"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useRef, useState} from \"react\";\nimport '../assets/scss/FooterPlayer.scss';\nimport RepeatIcon from '@material-ui/icons/Repeat';\nimport RepeatOneIcon from '@material-ui/icons/RepeatOne';\nimport SkipPreviousIcon from '@material-ui/icons/SkipPrevious';\nimport SkipNextIcon from '@material-ui/icons/SkipNext';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport VolumeUpIcon from '@material-ui/icons/VolumeUp';\nimport VolumeOffIcon from '@material-ui/icons/VolumeOff';\nimport Slider from \"@material-ui/core/Slider\";\nimport {Avatar} from \"@material-ui/core\";\nimport ControlsToggleButton from \"./ControlsToggleButton\";\nimport Name from \"./Name\";\nimport {ThemeContext} from \"../../api/Theme\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {setBannerOpen, setCurrentPlaying} from \"../../actions/actions\";\nimport Button from \"@material-ui/core/Button\";\n\nfunction FooterMusicPlayer({music}) {\n\n    const [{id, name, author_name, img, musicName}, setCurrTrack] = useState(music);\n    const [isRepeatClicked, setRepeatClick] = useState(false);\n    const [isPrevClicked, setPrevClicked] = useState(false);\n    const [isNextClicked, setNextClicked] = useState(false);\n    const [isPlaying, setPlayPauseClicked] = useState(false);\n    const [isVolumeClicked, setVolumeClicked] = useState(false);\n    const [volume, setVolume] = useState(50);\n    const [seekTime, setSeekTime] = useState(0);\n    const [duration, setDuration] = useState(0);\n    const [currTime, setCurrTime] = useState(0);\n    const [bannerToggle,setBannerToggle] = useState(false);\n\n    const audioElement = useRef();\n    const dispatch = useDispatch();\n    const {playlists} = useSelector(state => state.musicReducer);\n    const useStyle = useContext(ThemeContext);\n    const pointer = { cursor: \"pointer\",  color: useStyle.theme };\n\n    const handleToggle = (type, val) => {\n        switch (type) {\n            case \"repeat\":\n                setRepeatClick(val);\n                break;\n            case \"prev\":\n                setPrevClicked(val);\n                break;\n            case \"play-pause\":\n                setPlayPauseClicked(val);\n                break;\n            case \"next\":\n                setNextClicked(val);\n                break;\n            case \"volume\":\n                setVolumeClicked(val);\n                break;\n            default:\n                break;\n        }\n    };\n    const handleSeekChange = (event, newValue) => {\n        audioElement.current.currentTime =(newValue*duration)/100;\n        setSeekTime(newValue)\n    };\n    const handleVolumeChange = (event, newValue) => {\n        setVolume(newValue);\n    };\n    const handleBannerToggle = ()=> {\n        setBannerToggle(!bannerToggle);\n    };\n\n\n    useEffect(()=>{\n        dispatch(setBannerOpen(bannerToggle));\n    },[dispatch,bannerToggle]);\n\n\n    useEffect(() => {\n        isPlaying\n            ? audioElement.current.play().then(()=>{}).catch((e)=>{audioElement.current.pause(); audioElement.current.currentTime=0;})\n            : audioElement.current.pause();\n        audioElement.current.loop = isRepeatClicked;\n        audioElement.current.volume = volume / 100;\n        audioElement.current.muted = isVolumeClicked;\n        audioElement.current.onloadeddata = () => {\n            if (audioElement.current != null)\n                setDuration(audioElement.current.duration)\n        };\n        setInterval(() => {\n            if (audioElement.current !== null)\n                setCurrTime(audioElement.current.currentTime);\n        })\n    });\n\n    useEffect(() => {\n        setCurrTrack(music);\n    }, [music]);\n\n\n    useEffect(() => {\n        setSeekTime((currTime) / (duration / 100))\n    }, [currTime, duration]);\n\n\n\n    useEffect(()=>{\n        audioElement.current.onended = ()=> {\n            setNextClicked(true);\n        };\n    })\n\n    useEffect(()=>{\n        if (isNextClicked){\n            let currTrackId = (id+1) % playlists.length;\n            dispatch(setCurrentPlaying(playlists[currTrackId]));\n            setNextClicked(false);\n        }\n        if (isPrevClicked){\n            let currTrackId = (id-1) % playlists.length;\n            if ((id-1)<0){\n                currTrackId = playlists.length - 1;\n            }\n            dispatch(setCurrentPlaying(playlists[currTrackId]));\n            setPrevClicked(false);\n        }\n    },[dispatch, id, isNextClicked, isPrevClicked, playlists]);\n\n\n    function formatTime(secs) {\n        const t = new Date(1970, 0, 1);\n        t.setSeconds(secs);\n        let s = t.toTimeString().substr(0, 8);\n        if (secs > 86399)\n            s = Math.floor((t - Date.parse(\"1/1/70\")) / 3600000) + s.substr(2);\n        return s.substring(3);\n    }\n    return (\n        <div style={useStyle.component} className={\"footer-player\"}>\n            <div className=\"playback\">\n                {\n                    !isNaN(seekTime) &&\n                    <Slider style={{color: useStyle.theme}}\n                            className={\"playback-completed\"}\n                            value={seekTime} onChange={handleSeekChange}/>\n                }\n            </div>\n            <Button\n                    startIcon={<Avatar variant=\"square\" src={require(\"../assets/img/\" + img).default} alt={name}/>}\n                    onClick={handleBannerToggle}\n                    className=\"curr-music-container\">\n                <div className=\"curr-music-details\">\n                    <Name name={name} className={\"song-name\"} length={name.length}/>\n                    <Name name={author_name} className={\"author-name\"}\n                          length={author_name.length}/>\n                </div>\n            </Button>\n            <div className=\"playback-controls\">\n\n                <ControlsToggleButton style={pointer} type={\"repeat\"}\n                                      defaultIcon={<RepeatIcon fontSize={\"large\"}/>}\n                                      changeIcon={<RepeatOneIcon fontSize={\"large\"}/>}\n                                      onClicked={handleToggle}/>\n\n                <ControlsToggleButton style={pointer} type={\"prev\"}\n                                      defaultIcon={<SkipPreviousIcon fontSize={\"large\"}/>}\n                                      change    Icon={<SkipPreviousIcon fontSize={\"large\"}/>}\n                                      onClicked={handleToggle}/>\n\n                <audio ref={audioElement} src={require(\"../assets/music/\" + musicName).default} preload={\"metadata\"}/>\n\n                <ControlsToggleButton style={pointer} type={\"play-pause\"}\n                                      defaultIcon={<PlayArrowIcon fontSize={\"large\"}/>}\n                                      changeIcon={<PauseIcon fontSize={\"large\"}/>}\n                                      onClicked={handleToggle}/>\n\n\n                <ControlsToggleButton style={pointer} type={\"next\"}\n                                      defaultIcon={<SkipNextIcon fontSize={\"large\"}/>}\n                                      changeIcon={<SkipNextIcon fontSize={\"large\"}/>}\n                                      onClicked={handleToggle}/>\n            </div>\n            <div className=\"playback-widgets\">\n                <div className=\"timer\">\n                    <p>\n                        <span>{formatTime(currTime)}</span>\n                        /\n                        <span>{formatTime(duration)}</span>\n                    </p>\n                </div>\n                <div className={\"slider\"}>\n                    <Slider style={{color: useStyle.theme}} value={volume} onChange={handleVolumeChange}/>\n                </div>\n                <ControlsToggleButton style={pointer} type={\"volume\"}\n                                      defaultIcon={<VolumeUpIcon/>}\n                                      changeIcon={<VolumeOffIcon/>}\n                                      onClicked={handleToggle}/>\n            </div>\n        </div>\n\n    );\n}\n\nexport default FooterMusicPlayer;"]},"metadata":{},"sourceType":"module"}